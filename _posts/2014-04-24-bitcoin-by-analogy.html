---
layout: post
title: Bitcoin by analogy
date: '2014-04-24T11:51:00.000-07:00'
author: Yevgeniy Brikman
tags:
- Software Engineering
- Bitcoin
modified_time: '2014-04-29T13:49:56.625-07:00'
thumbnail: http://1.bp.blogspot.com/-Z4lnMEfZ3_s/U1iwRj_cucI/AAAAAAAARAM/RRD7TCtA1Gc/s72-c/bitcoin-logo.png
blogger_id: tag:blogger.com,1999:blog-5422014336627804072.post-879076770255702128
blogger_orig_url: http://brikis98.blogspot.com/2014/04/bitcoin-by-analogy.html
---

<style>  .bitcoin-message {      padding: 7px;      border: 1px solid #000;      -webkit-border-radius: 8px;      -moz-border-radius: 8px;      border-radius: 8px;      width: auto;     margin: 3px auto;     font-family: monospace;     background-color: #fab874;       color: #000;    }    .bitcoin-message td, .bitcoin-ledger td {     padding: 0 10px;     vertical-align: top;   }    .bitcoin-ledger {     padding: 7px;      border: 1px solid #CCC;      width: auto;     margin: 3px auto;     font-family: monospace;     background-color: #fffca8;   }    .bitcoin-caption {     font-size: 10px;     text-align: center;   }    .code-block {     display: block;     padding: 15px 8px;      border: 1px solid #CCC;      font-size: 12px;     background-color: #F8F8FF;   } </style> <br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-Z4lnMEfZ3_s/U1iwRj_cucI/AAAAAAAARAM/RRD7TCtA1Gc/s1600/bitcoin-logo.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-Z4lnMEfZ3_s/U1iwRj_cucI/AAAAAAAARAM/RRD7TCtA1Gc/s320/bitcoin-logo.png" /></a></div><br /><blockquote class="tr_bq"><i>Hackers are the animals that can detect a storm coming or an earthquake. They just know, even though they don’t know why, and there are two big things hackers are excited about now and can’t articulate why – Bitcoin and 3D printing.</i><br /><br /><div style="text-align: right;">Paul Graham, <a href="http://blogs.wsj.com/venturecapital/2013/05/07/coinbase-nabs-5m-in-biggest-funding-for-bitcoin-startup/">Wall Street Journal</a></div></blockquote><a href="https://bitcoin.org/">Bitcoin</a> is the first purely digital, decentralized money. It has been on my mind a lot lately and apparently, I'm not the only one. Paul Graham called it a <a href="https://news.ycombinator.com/item?id=5402513">paradigm shift</a>; Marc Andreessen believes <a href="http://dealbook.nytimes.com/2014/01/21/why-bitcoin-matters/">Bitcoin is as big of a technological breakthrough as PCs and the Internet</a>; Ben Bernanke said virtual currencies <a href="http://qz.com/148399/ben-bernanke-bitcoin-may-hold-long-term-promise/">may hold long-term promise</a>; <a href="http://cdixon.org/2013/12/31/why-im-interested-in-bitcoin/">Chris Dixon is investing millions in it</a>; <a href="http://motherboard.vice.com/blog/why-silicon-valley-and-google-loves-bitcoin">Google is interested in Bitcoin</a>; <a href="http://www.forbes.com/sites/jonmatonis/2012/06/13/why-apple-is-afraid-of-bitcoin/">Apple is afraid of it</a>. In short, Bitcoin is something you should be paying attention to.<br /><br />Using Bitcoin is easy: to pay with Bitcoin, you just install an app called a <a href="https://bitcoin.org/en/choose-your-wallet">Bitcoin wallet</a> on your computer or mobile device and click some buttons in the app to send money to other Bitcoin users over the Internet:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-5RRzhcOKf0Q/U1XlmIsP68I/AAAAAAAAQ5s/1DkzmPr5ASQ/s1600/bitcoin-wallet-ss3.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-5RRzhcOKf0Q/U1XlmIsP68I/AAAAAAAAQ5s/1DkzmPr5ASQ/s1600/bitcoin-wallet-ss3.jpg" height="320" width="191" /></a></div><br />To receive money, you just give people your bitcoin address, or <a href="http://bitcoinqrcode.org/">create a QR code</a>. For example, here's mine:<br /><br /><div style="text-align: center;"><a href="bitcoin:1G8qEUVUS8BBSwSWNM4EWR622vUpGtee66?amount=0.5&amp;label=Bitcoin%20by%20analogy">    <img src="http://i.imgur.com/wP4I80O.png" />  </a>  <br /><a href="bitcoin:1G8qEUVUS8BBSwSWNM4EWR622vUpGtee66amount=0.5&amp;label=Bitcoin%20by%20analogy">    1G8qEUVUS8BBSwSWNM4EWR622vUpGtee66   </a></div><br />Understanding what's happening under the hood is a bit trickier. I read a number of articles, but still couldn't wrap my head around many of the details. Therefore, in the spirit of "the best way to learn is to teach", I forced myself to write this blog post as a learning tool.<br /><br />The post is broken up into a series of questions about Bitcoin:<br /><ol><li><b>Validity</b>:<b> </b>is Bitcoin really money?</li><li><b>Decentralized money</b>: how can you have a currency that no one controls?</li><li><b>Decentralized mint</b>: how is money created in Bitcoin?</li><li><b>Decentralized transactions</b>: how do you transfer money in Bitcoin?</li><li><b>Decentralized ledgers</b>: how are transactions recorded in Bitcoin?</li><li><b>Further reading</b>: where can I find more info?</li></ol>Also, in the spirit of "if you can't explain it simply, you don't understand it well enough", I've tried to make the key Bitcoin concepts accessible to audiences without a programming background. Most sections in this post start with a simple analogy for Bitcoin that involves no tech whatsoever before diving into the tech details.<br /><br />Of course, I'm a Bitcoin novice myself, so if after reading this you're still confused, or I've made any errors or omissions, please leave a comment!<br /><br /><b><span style="font-size: x-large;">Validity</span></b><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-pDvcoh_M0OU/U1GcnejPHDI/AAAAAAAAQx4/zRSYmNi0ojU/s1600/Bitcoin-accepted-here.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-pDvcoh_M0OU/U1GcnejPHDI/AAAAAAAAQx4/zRSYmNi0ojU/s1600/Bitcoin-accepted-here.png" height="122" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div>Before discussing how Bitcoin works, let's answer a common question: how can Bitcoin be considered money? It was created by a bunch of computer programmers with no government backing; it's purely digital, so it exists only on computers and has no "intrinsic value"; it might not even fit the standard <a href="http://en.wikipedia.org/wiki/Bitcoin#Classification_as_money">definition of money</a> because it's not a <a href="http://en.wikipedia.org/wiki/Store_of_value">stable store of value</a> and rarely used as a <a href="http://en.wikipedia.org/wiki/Unit_of_account">unit of account</a>.<br /><br />Despite all that, Bitcoin is still used as a <a href="http://en.wikipedia.org/wiki/Medium_of_exchange">medium of exchange</a>: thousands of merchants are willing to accept Bitcoin in trade for real goods or services. Why? Because these merchants see Bitcoin as an effective medium of exchange and they believe that other merchants will feel the same way in the future. Or, to put it another way:<br /><blockquote class="tr_bq"><i>It’s not as much that the Bitcoin currency has some arbitrary value and then people are trading with it; it’s more that people can trade with Bitcoin (anywhere, everywhere, with no fraud and no or very low fees) and as a result it has value.</i><br /><br /><div style="text-align: right;"><i><i>Marc Andreessen, <a href="http://dealbook.nytimes.com/2014/01/21/why-bitcoin-matters/">Why Bitcoin Matters</a></i></i></div></blockquote><span style="font-size: x-large;"><b>Decentralized money (analogy)</b></span><br /><br /><a href="http://en.wikipedia.org/wiki/Yap">Yap</a> is a nation in the South Pacific that uses a unique form of money called <a href="http://en.wikipedia.org/wiki/Rai_stones">Rai stones</a>, which are&nbsp;circular disks carved out of limestone, with a hole in the middle, that can be up to 12 feet in diameter and weigh up to 8,800 lbs!<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-fFrOMJen4UE/U1dMy1drocI/AAAAAAAAQ6s/F-wDYrLekLs/s1600/Yap_Stone_Money.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-fFrOMJen4UE/U1dMy1drocI/AAAAAAAAQ6s/F-wDYrLekLs/s1600/Yap_Stone_Money.jpg" height="260" width="320" /></a></div><br />Trading stones of this size is difficult: no one wants to cart around a 4 ton stone every time they make a purchase. As a result, the Yapese came up with a clever solution: they decided to determine ownership by verbal agreement. Whenever there was a trade, the parties involved would communicate to the rest of the tribe the amount of stone that had been exchanged. The stones wouldn't actually move from one house to another, but the knowledge of who owned what was memorized and handed down through oral history.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-gVmlWjzzxjg/U1h2EqPtd-I/AAAAAAAAQ-g/wfZiQJHpOag/s1600/raiyap3.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-gVmlWjzzxjg/U1h2EqPtd-I/AAAAAAAAQ-g/wfZiQJHpOag/s1600/raiyap3.jpg" height="260" width="400" /></a></div><br />At this point, I must apologize to historians: in the rest of the post, I'm going to completely reinvent Yap history so I can use it as an effective analogy for understanding Bitcoin.<br /><br />As a first step, imagine that a tribe on Yap struggled to accurately track Rai ownership purely through memory and oral history. After many arguments and fights over who owns what, they decided they were going to write down every transaction in a book called a ledger, which would be considered the source of truth.<br /><br />The chief appointed one of the tribesmen as the bookkeeper. If Alice wanted to pay Bob 10 lbs of Rai, Alice would go to the bookkeeper's house and announce the transaction. The bookkeeper would go through the ledger, make sure Alice actually owned 10 lbs of Rai, and if she did, add the new transaction to the book.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-iaprWFbRjPI/U1hsZq-kG1I/AAAAAAAAQ9o/LYAEra_uHb8/s1600/Bitcoin+central+bookkeeper.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-iaprWFbRjPI/U1hsZq-kG1I/AAAAAAAAQ9o/LYAEra_uHb8/s1600/Bitcoin+central+bookkeeper.png" /></a></div>Everything worked well for a while, but gradually, problems appeared: the bookkeeper started charging transaction fees; trade would sometimes halt entirely because the bookkeeper was on vacation or sick; &nbsp;pressured by the chief, the bookkeeper would charge very high fees or completely ban certain transactions, especially with other tribes; sometimes, after a dispute, the bookkeeper would seize someone's assets entirely. Eventually, the bookkeeper became one of the most rich, powerful, and controversial figures in society: despite rumors of corruption, fraud, and favoritsm, who would dare question the person who controls all the money?<br /><br />10 families in the tribe, upset with the bookkeeper's behavior, decided to find a new way to manage their money. Since a single person cannot be trusted to maintain the ledger, these families had a radical idea:&nbsp;<i>every</i>&nbsp;family would maintain its own ledger!<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-BQLec-lw5aw/U1htpBcRPlI/AAAAAAAAQ90/5uGDPRxABNE/s1600/Bitcoin+distributed+ledgers.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-BQLec-lw5aw/U1htpBcRPlI/AAAAAAAAQ90/5uGDPRxABNE/s1600/Bitcoin+distributed+ledgers.png" /></a></div><br />For example, if Alice wanted to to pay Bob 10 lbs of Rai, Alice would go to the center of town and announce the new transaction to all the other families. Each family would then check their own ledger, make sure Alice really had 10 lbs of Rai, and if she did, add the new transaction to their ledger. Since each family now kept a ledger, no one family had more power than any other!<br /><br /><b style="font-size: xx-large;">Decentralized money (tech details)</b><br /><br />All modern currencies, such as the US Dollar and Euro, are centralized: that is, they are controlled by a small number of institutions, such as governments, banks, and credit card companies. For example, if Alice wants to transfer $10 to Bob, she'll login to her bank's website,&nbsp;wait for the bank to verify her identity,&nbsp;send the transfer information to the bank's servers, wait a few days for the bank to clear the transaction, at which point the bank will update her balance, and send the info over to Bob's bank. In short, even though it's Alice's money, the entire process is controlled by the bank's rules and procedures:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-NfKOc0LIQ-o/U1hxuSspxNI/AAAAAAAAQ-M/gYEmnXOMNU8/s1600/Bitcoin+send+dollars.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" src="http://3.bp.blogspot.com/-NfKOc0LIQ-o/U1hxuSspxNI/AAAAAAAAQ-M/gYEmnXOMNU8/s1600/Bitcoin+send+dollars.png" height="258" width="400" /></a></div><br />This centralized approach has the same problems as the Yap bookkeeper: even though it's your money, a small group of institutions controls almost everything about it, including who can spend money, when they can spend it, what they can spend it on, where they can spend it, what fees and taxes are imposed, and so on.<br /><br />Bitcoin offers an alternative without all of these limitations: a decentralized currency. As in the Yap analogy, Bitcoin uses a distributed ledger approach. Of course, instead of 10 families, Bitcoin consists of thousands of computers, each of which maintains its own ledger; and instead of someone yelling from the town center, these computers communicate with each other by sending messages over the Internet.<br /><br />For example, if Alice was transferring 10 Bitcoins to Bob, she'd click some buttons in her Bitcoin wallet, and it would broadcast this transaction to all other Bitcoin users:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-yWTuefcsmx8/U1jmlh0um_I/AAAAAAAARBI/DDtqIFDjV-E/s1600/Bitcoin+send+message.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-yWTuefcsmx8/U1jmlh0um_I/AAAAAAAARBI/DDtqIFDjV-E/s1600/Bitcoin+send+message.png" height="391" width="400" /></a></div><br />This collection of computers is known as the <a href="http://en.wikipedia.org/wiki/Bitcoin_network">Bitcoin network</a> and anyone can join it by installing the <a href="https://bitcoin.org/en/download">Bitcoin software</a>, which will automatically download the global ledger onto your computer. This allows you to see every transaction that has ever happened in Bitcoin's history! You can even browse them online on sites like <a href="https://blockchain.info/">blockchain.info</a> and <a href="http://blockexplorer.com/">blockexplorer.com</a>. This is a very different model of privacy than you get with banks, so you may want to check out <a href="https://bitcoin.org/en/protect-your-privacy">Bitcoin privacy</a> and <a href="https://bitcoin.org/en/faq#is-bitcoin-anonymous">Is Bitcoin anonymous</a> for more info.<br /><br />When each of these computers - I'll refer to them as "nodes" to indicate that they are running Bitcoin software that automatically handles all of these tech details - receives Alice's message, it'll check its ledger to make sure Alice owns 10 Bitcoins, and if she does, add the new entry to the ledger.<br /><br /><b><span style="font-size: x-large;">Decentralized mint (analogy)</span></b><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-kel7ShnAST8/U1h2S3Kx3VI/AAAAAAAAQ-o/Zo6X0PBym18/s1600/mining.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-kel7ShnAST8/U1h2S3Kx3VI/AAAAAAAAQ-o/Zo6X0PBym18/s1600/mining.png" height="200" width="200" /></a></div><br />In a decentralized system, there is no mint to create money. So how do more Rai stones enter circulation? The answer is mining!<br /><br />There is no limestone on the Yap islands themselves, so the villagers have to sail to distant islands to find it. The limestone is scarce and randomly distributed, so finding it can take a long time and is mostly a matter of luck. If Alice mines some new stone, she can get all the villagers to recognize that she now owns more Rai by displaying the new stone in front of her home and announcing it to the other villagers. All villagers will enter this in their ledgers as a transaction where Alice is the recipient of some amount of Rai stone.<br /><br /><b><span style="font-size: x-large;">Decentralized mint (tech details)</span></b><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/--Ll6XQJINQc/U1GeYDtxTsI/AAAAAAAAQyQ/FTUTmQshPsA/s1600/bitcoin-miner.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/--Ll6XQJINQc/U1GeYDtxTsI/AAAAAAAAQyQ/FTUTmQshPsA/s1600/bitcoin-miner.jpg" height="222" width="320" /></a></div><br /><br />How do Bitcoins get created? The answer here is <i>also</i> mining!<br /><br />However, <a href="https://en.bitcoin.it/wiki/Mining">Bitcoin mining</a>&nbsp;does not involve any pick axes: it's purely digital. Any Bitcoin node that solves a computationally expensive math problem gets Bitcoin as a reward! Much like the stone mining, these math problems can take a long time to solve, and which node solves it first is mostly a matter of luck. However, once some lucky node finds a solution, it will broadcast it out to the rest of the Bitcoin network, and all other nodes will record in their ledgers that the lucky node has earned some new Bitcoin.<br /><div><br />The problems to solve involve <a href="http://en.wikipedia.org/wiki/Cryptographic_hash_function">cryptographic hash functions</a>; the math behind them is beyond the scope of this post, but I'll give a brief introduction.<br /><br />If you pass a string of text through a cryptographic hash function, it will convert it to a different string of text, called the "digest", in a totally unpredictable manner:<br /><br /><code class="code-block">cryptographic-function("Hello World") = 124610xktj1l32kxjcj24j1</code><br />Given the slightest change to the text, such as adding an exclamation point, you get a totally different digest as output:<br /><br /><code class="code-block">cryptographic-function("Hello World!") = 444lkxckl15lsck51lk234</code><br />The most important feature of cryptographic hash functions is that they are "one way": for a given string <code>T</code>, you'll always get back the same digest <code>D</code>; however, given an arbitrary digest <code>D</code>, there is no way to figure out what was the original text <code>T</code>. In other words, there is no way to "reverse" the hash function.<br /><br />In Bitcoin mining, you pass two pieces of data into the <a href="http://en.wikipedia.org/wiki/SHA-2">SHA-256</a> cryptographic hash function:<br /><ol><li>Information about a block, <span style="font-family: monospace;">B</span>: we'll discuss the details of this later</li><li>A random guess, <span style="font-family: monospace;">R</span></li></ol><code class="code-block">sha-256(B, R) = digest</code><br />The goal is to find the right <code>R</code> so that you get back a digest that starts with some required number of leading zeroes:<br /><br /><code class="code-block">sha-256(B, R) = 00000000000001234sdfxxc1414...</code><br />Since cryptographic hash functions are "one way", there is no way to know what value(s) of <span style="font-family: monospace;">R</span>&nbsp;will produce a digest that starts with zeroes. All you can do is repeatedly guess random values of <span style="font-family: monospace;">R</span> until you accidentally stumble across one that works. Since SHA-256 has 2<sup>256</sup> possible outputs, as the number of required leading zeroes goes up, the odds of any one guess being right becomes extremely small.<br /><br />In fact, the problem is intentionally designed - and occasionally recalibrated (see <a href="https://blockchain.info/stats">Blockchain stats</a>) - to take a very long time: a single computer will have to guess non-stop, on average, for <i>several years</i> to find the right value of <span style="font-family: monospace;">R</span>. However, with all the nodes on the Bitcoin network guessing, the average time to find the right value of <span style="font-family: monospace;">R</span> is roughly 10 minutes.<br /><br />Spending so much CPU time and energy on useless calculations may seem wasteful, but as we'll see later, the fact that the calculations are expensive is essential in establishing a consistent timeline.<br /><br />A few interesting notes on Bitcoin mining:<br /><ol><li>There is pre-determined, <a href="https://en.bitcoin.it/wiki/Controlled_Currency_Supply">fixed supply</a> of Bitcoin: every year, the number of Bitcoins that can be mined will drop by half and the total supply will max out at 21 million. </li><li>After all Bitcoins have been mined, the reward for mining will switch to small fees on each Bitcoin transaction. These are expected to be significantly smaller than bank or credit card fees. </li><li>The number of nodes participating in Bitcoin mining today means it is not practical or cost effective to try to do mining on your home computer. Instead, the recommendation is to join a mining pool and even invest in dedicated hardware (see <a href="http://bitcoinmining.com/">bitcoinmining.com</a> for more info).</li><li>The fixed supply of Bitcoin is not a problem as you can pay with tiny fractions of a Bitcoin, all the way down to 0.00000001 BTC, known as a <a href="http://bitcoin.stackexchange.com/questions/114/what-is-a-satoshi">Satoshi</a>. </li></ol></div><b style="font-size: xx-large;">Decentralized transactions (analogy)</b><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-h3M6C-ARJno/U1dbhS4AgYI/AAAAAAAAQ7M/qI7D-PfoEqs/s1600/bh0010ap14.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" src="http://2.bp.blogspot.com/-h3M6C-ARJno/U1dbhS4AgYI/AAAAAAAAQ7M/qI7D-PfoEqs/s1600/bh0010ap14.jpg" height="273" width="400" /></a></div><br />Each of the 10 families maintains a ledger by hand that lists every transaction that has ever happened. Each transaction consists of 3 sections:<br /><ol><li><b>From</b>: the name of the person sending money. </li><li><b>To</b>: the name of the recipient of the money.</li><li><b>Amount</b>:<b> </b>how many pounds of Rai stone to transfer.</li></ol>To find out Alice's balance, you start at the beginning of the book and go through every transaction, adding up transactions where she received money, and subtracting transactions where she sent money. When Alice announces a new transaction, before adding it to the book, you can use this balance calculation to make sure she has enough money for the transaction.<br /><br /><b style="font-size: xx-large;">Decentralized transactions (tech details)</b><br /><br /><div class="separator" style="clear: both; text-align: center;"></div>The Yap transactions contained three pieces of data: From, To, and Amount. With Bitcoin, the To and From fields are tricky: we can't just look to the town center to see who is announcing a new transaction and in a decentralized world, there is no central system to store usernames and passwords.<br /><br />To manage and verify identity in a decentralized fashion, Bitcoin uses <a href="http://en.wikipedia.org/wiki/Public-key_cryptography">public key cryptography</a>. Public key cryptography involves lots of math that is beyond the scope of this post, so this section is just a brief intro to make it clear how it applies to Bitcon.<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-7PXDhLKQ3eo/U1huk0VO8MI/AAAAAAAAQ-E/gp7axOSgvBE/s1600/circuit-lock-250x165.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-7PXDhLKQ3eo/U1huk0VO8MI/AAAAAAAAQ-E/gp7axOSgvBE/s1600/circuit-lock-250x165.jpg" /></a></div><br />In this form of cryptography, there are two keys, or long strings of letters and numbers, that are mathematically linked:<br /><ol><li><b>Public key</b>: a public identifier that can be freely shared with others.</li><li><b>Private key</b>:<b> </b>a secret or password that must never be shared with anyone.</li></ol>When you install a Bitcoin wallet on your computer, it will automatically generate a public and private key pair for you. You can freely share your public key: in fact, the public key is your identity or address in Bitcoin.<br /><br />Public/private keys can be used for several tasks, but the main one we care about is "authenticity": that is, we can use them to mathematically verify that a message really came from the person we expect and that the message contents have not been modified along the way.<br /><br />Every time Alice sends a message, she can pass the contents of the message, along with her private key, through a <code>sign</code> function:<br /><br /><code class="code-block">sign("Hello World", Alice's private key) = n67n54n6l10xf15</code><br />The value she gets back, called a <a href="http://en.wikipedia.org/wiki/Digital_signature">digital signature</a>, is a completely unrecognizable string of letters and numbers. Without Alice's private key, there is no way to guess what that string should be. Moreover, if you change the input text at all, even by a single character, such as adding an exclamation point to "Hello World", the signature will change in totally unpredictable ways:<br /><br /><code class="code-block">sign("Hello World!", Alice's private key) = vk34jxl140501025</code><br />This is similar to the cryptographic hash functions we saw earlier, except that the mathematical link between the private and public keys means Bob can use Alice's public key to verify the signature:<br /><br /><code class="code-block">verify("n67n54n6l10xf15", "Hello World", Alice's public key) = valid or invalid</code><br />If the signature is "valid", then Bob can be confident that it was really Alice who sent the message and that the message is exactly as she originally created it.<br /><br />We now know enough to take a look at a typical Bitcoin transaction. For example, if Alice was sending 10 Bitcoins to Bob, the message might look something like this:<br /><br class="Apple-interchange-newline" /><table class="bitcoin-message"><tbody><tr><td>Signature:</td><td>mn546yhg (signed with Alice's private key)<br /><br /></td></tr><tr><td>Inputs:</td><td>nhn3891a (transaction where Alice got 7 BTC)<br />vc4232v32&nbsp;(transaction where Alice got 3 BTC)<br /><br /></td></tr><tr><td>Outputs:</td><td>To: 60sdfs951sdfxo66 (Bob's public key)<br />Amount: 10 Bitcoins</td></tr></tbody></table><br />The message consists of 3 sections:<br /><ol><li><b>Signature</b>: Alice includes a digital signature with her messages so that other Bitcoin nodes can verify the message really came from her. </li><li><b>Inputs</b>: this is a list of the signatures of transactions already in the ledger where Alice was the recipient of Bitcoins. In other words, these are the funds Alice is using in this transaction, a total of 10 Bitcoins.</li><li><b>Outputs</b>: this is a list of how the funds in the inputs should be distributed. To keep calculations simple, you are required to redistribute <i>all</i> the funds in the inputs.&nbsp;You can include more than one recipient in the ouputs section - including yourself, if you need change. In this case, Alice is sending 10 Bitcoin to a single recipient, Bob, identified by his public key.</li></ol>Since each transaction references a previous transaction in its "inputs" section, it is possible to follow the graph of transactions all the way back to the beginning of Bitcoin. This is the mechanism for checking the ownership of bitcoins!<br /><br />For example, to calculate a user's balance, we use an approach very similar to the Yap ledger: you go through every transaction, add up the ones where the user was a recipient, and subtract the ones where they were a sender. To check that a new message is valid, such as Alice's transfer to Bob, you can check that the inputs refer to valid transactions already in the ledger where Alice was the recipient.<br /><div><ol></ol></div><b><span style="font-size: x-large;">Decentralized ledgers (analogy)</span></b><br /><br />Over time, the number of families using the distributed ledger system grew from 10 to 30. The homes for the new families were spread out, so instead of one town center, there were now 3 town centers, one for every 10 houses. Therefore, when Alice wanted to transfer 10 lbs of Rai to Bob, she had to announce the transaction 3 times. <br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-F45dvsVxAls/U1h4oKPiH0I/AAAAAAAAQ-0/BB_prh9DaiQ/s1600/Bitcoin+multiple+village+centers.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" src="http://1.bp.blogspot.com/-F45dvsVxAls/U1h4oKPiH0I/AAAAAAAAQ-0/BB_prh9DaiQ/s1600/Bitcoin+multiple+village+centers.png" /></a></div><br />Eventually, the villagers noticed that this led to a problem: the order of transactions was not consistent across all ledgers! This could lead to problems. For example, Alice wants to transfer 10 lbs of Rai to Bob. She announces it at village center #1 and heads off to announce it at the other village centers. Bob, who lives near village center #1, hears Alice's announcement and, excited to finally have some money, immediately starts his own transaction to transfer 10lbs of Rai to Carole. Bob announces his transaction at village center #1, where all the families now have the follow transaction order:<br /><ol><li>Alice -&gt; Bob, 10 lbs Rai</li><li>Bob -&gt; Carole, 10 lbs Rai</li></ol>Bob then heads off to village center #2 to make the same announcement. However, it turns out that Alice went to village center #3 first and hasn't made it to #2 yet. As a result, the families in village center #2 have the following transaction order:<br /><ol><li>Bob -&gt; Carole, 10 lbs Rai</li><li>Alice -&gt; Bob, 10 lbs Rai</li></ol>The ledgers in different villages centers are out of sync! Moreover, since Bob had no money before Alice's transaction, the families in village center #2 reject his transaction, even though the families in village center #1 accepted it!<br /><br />We need a way to establish a consistent order of transactions in all ledgers in a decentralized way. For example, simply letting a single family choose the order wouldn't work since that family could use that power to their advantage (e.g. by constantly delaying a rival family's transactions). This is a hard problem, but the ingenious villagers once again came up with a clever solution: use random chance!<br /><br />Here's the idea: when a new transaction comes in, the first step is to add it to an "unverified" transactions list. For example, when Alice announces her transfer of 10 lbs of Rai to Bob, the ledger and unverified lists would look like this:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-81lFJT10uKU/U1ii-VSCBeI/AAAAAAAAQ_w/8Zbp2DbWiLs/s1600/Bitcoin+Yap+ledger+++unverified.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-81lFJT10uKU/U1ii-VSCBeI/AAAAAAAAQ_w/8Zbp2DbWiLs/s1600/Bitcoin+Yap+ledger+++unverified.png" /></a></div><br />Every time a family mines new Rai stone, to get all the families to recognize the new stone in their ledgers, this family must pick one transaction to move from the unverified list to the ledger.<br /><br />This mechanic accomplishes several goals at once:<br /><ol><li>Since limestone is scarce and randomly distributed, it's a matter of luck which family will get to "verify" the next transaction, so no family can control transaction order to their advantage.</li><li>Every family now has a strong incentive to participate in maintaining ledgers: it's the only way that their newly mined limestone will be allowed to enter circulation!</li><li>Since new limestone is randomly distributed and takes a long time to find, the odds of two families overlapping in finding new stone are essentially zero*. This give us a consistent ordering for transactions: in the case above, either all village centers accept Bob's transfer to Carole or all of them reject it.</li></ol><div>* To be honest, point #3 is not entirely accurate: an overlap would be rare, but <i>could</i>&nbsp;still happen. Unfortunately, this is one place where I can't find a <i>simple</i>&nbsp;analogy that captures the math Bitcoin uses to handle these occasional overlaps. Nevertheless, the main point still holds: a random, unpredictable process means no family will be able to control the order of multiple transactions in a row.</div><br /><b><span style="font-size: x-large;">Decentralized ledgers (tech details)</span></b><br /><br />The naive strategy of immediately adding new transactions to the ledger didn't work for the Yap when they got too big; since Bitcoin is several orders of magnitude bigger (thousands of nodes, multiple transactions per second), the strategy definitely doesn't work for Bitcoin. So how does Bitcoin establish a consistent timeline amongst distributed ledgers?<br /><br />It turns out that this is a general problem in distributed systems research known as the <a href="http://en.wikipedia.org/wiki/Two_Generals'_Problem">Byzantine Generals Problem</a>. As we'll discuss next, Bitcoin offers the first practical (read: probabilistic) solution to this problem - see <a href="http://expectedpayoff.com/blog/2013/03/22/bitcoin-and-the-byzantine-generals-problem/">Bitcoin &amp; the Byzantine Generals Problem</a> for more info.<br /><br />The ledger in Bitcoin is called the <a href="https://en.bitcoin.it/wiki/Block_chain">block chain</a>. Here's a rough idea of what a block chain might look like:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-BPWs1TL943U/U1Sp2se2s7I/AAAAAAAAQ4w/HSbROnOBrhg/s1600/Bitcoin+Block+chain+small.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-BPWs1TL943U/U1Sp2se2s7I/AAAAAAAAQ4w/HSbROnOBrhg/s1600/Bitcoin+Block+chain+small.png" /></a></div><br />The block chain consists of a series of blocks (3 are shown above), where each block contains:<br /><ol><li><b>Transactions</b>: transactions or messages sent between users.</li><li><b>Proof of work</b>: this is the digest from Bitcoin mining!</li><li><b>Previous reference</b>: a reference to the digest of the previous block.</li></ol>Notice how each block has a reference to the previous block: this chain of references is what defines the timeline in the Bitcoin network. The transactions in a single block happened "at the same time" (there must be no dependencies between them); the transactions in previous blocks happened earlier. This is different than the Yap ledger, where order is implicit from the order the transactions are written in the ledger.<br /><br />You can follow the "previous references" from block to block, all the way back to the very first block, known as the <a href="https://en.bitcoin.it/wiki/Genesis_block">genesis block</a>. The genesis block was part of the seed data when Bitcoin was first created; how do all other blocks get added in a consistent order across all computers? Just as we discussed in the Yap analogy section, when new messages arrive at a Bitcoin node, they initially go into an "unverified" bucket:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-bwrjncuRfm4/U1Sp8jYb0nI/AAAAAAAAQ44/K7PoN1sJ59k/s1600/Bitcoin+Block+chain+unverified.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-bwrjncuRfm4/U1Sp8jYb0nI/AAAAAAAAQ44/K7PoN1sJ59k/s1600/Bitcoin+Block+chain+unverified.png" /></a></div><br />Any node in the Bitcoin network can put several unverified transactions into a block and send it out to the rest of the network as the proposed next block in the chain. The catch is that the proposed block must include a "proof of work", which is the solution to a computationally expensive math problem involving cryptographic hash functions. Sound familiar? That's right, this is Bitcoin mining!<br /><br />Just like the Yap families propose the next transaction when they mine new Rai stones, it is the Bitcoin miners who propose new blocks for the block chain when they mine new Bitcoin. Here are the rules: take all the text from several unverified transactions <code>T</code>, plus the digest of the most recent block in the ledger <code>D</code>, plus a random guess <code>R</code>, and do the following SHA-256 calculation:<br /><br /><code class="code-block">sha-256(T, D, R) = digest</code><br />The miners keep guessing different values of R until they find a digest with the required number of leading zeroes. The first miner to find it gets a reward of Bitcoin: to receive it, the miner must send out the new block, which includes the digest as the "proof of work", to all other Bitcoin nodes. Assuming the new block is valid, it becomes a part of the block chain:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-uvtmhQwev8w/U1Sq1sWrFDI/AAAAAAAAQ5E/E3-LSTSRprE/s1600/Bitcoin+Block+chain+verified.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-uvtmhQwev8w/U1Sq1sWrFDI/AAAAAAAAQ5E/E3-LSTSRprE/s1600/Bitcoin+Block+chain+verified.png" /></a></div><br />In the example above, block 54 is now part of the block chain - that is, the Bitcoin timeline - and all the transactions in it, including Alice's, are considered "verified".<br /><br />What if multiple nodes come up with a proof of work at the same time? This is a rare occurrence, but if it happens, the network will temporarily have multiple possible paths in the block chain:<br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-CAaleyVZYk4/U1M8NJD3UjI/AAAAAAAAQ1g/z79mKtaZk6w/s1600/Bitcoin+blockchain+fork+(1).png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-CAaleyVZYk4/U1M8NJD3UjI/AAAAAAAAQ1g/z79mKtaZk6w/s1600/Bitcoin+blockchain+fork+(1).png" height="106" width="320" /></a></div><br />The solution is simple: Bitcoin nodes always accept the longest available chain.<br /><br />In the example above, some parts of the network will be mining a new block that has 56 as its previous reference, and others will be mining a new block with 57 as its previous reference. Eventually, someone will complete a proof of work on one of these paths, making it the longest one. For example, if the first proof of work calculation to finish was for a new block on the block 57 path, the network would switch to this path, and the transactions in block 56 would get put back into the unverified bucket:<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-Rk5ROBiqVBE/U1M8ZMCkwtI/AAAAAAAAQ1o/L_mQAk6yxtE/s1600/Bitcoin+blockchain+dropped+(1).png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-Rk5ROBiqVBE/U1M8ZMCkwtI/AAAAAAAAQ1o/L_mQAk6yxtE/s1600/Bitcoin+blockchain+dropped+(1).png" height="108" width="400" /></a></div><br />Of course, it's possible that two blocks, one on each path, will be found simultaneously again, but a) this is even more unlikely and b) it just means that the block chain stays diverged for a little while longer while we wait for yet another block to be found. Eventually, <i>some</i> path will end up longer, and the network will converge on it.<br /><br /><div>Since nodes always accept the longest path, couldn't an attacker create their own block chain with lots of fraudulent transactions and get the whole network to adopt it, so long as it was longer? For example, if Mallory managed to generate blocks 59, 60, and 61 while the network was still working on 57 and 58, then Mallory's fraudulent blocks would be accepted and all the others would be dropped:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-zpPn_HNuMxo/U1itX-wWuCI/AAAAAAAARAA/8Vwl5e3xwHw/s1600/Bitcoin+blockchain+attacker.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-zpPn_HNuMxo/U1itX-wWuCI/AAAAAAAARAA/8Vwl5e3xwHw/s1600/Bitcoin+blockchain+attacker.png" height="136" width="400" /></a></div><br /></div><div>Attacks of this sort are very unlikely to succeed because Mallory is in a race against the <i>entire Bitcoin network </i>to generate those blocks. This is why the proof of work calculation is intentionally designed to be very expensive. Mallory would have to control more computing power than all other nodes on the Bitcoin network, combined, to have a viable chance of winning this race for a <i>single</i> block, let alone 3.<br /><br />This is the real reason Bitcoins are offered as a reward to miners: they are an incentive to make the network as big and active as possible, so an attacker has no chance of being faster than the rest of the network. In fact, most attackers will find it more profitable to use their computing resources to mine bitcoins legitimately instead of taking the risk of trying to add fraudulent blocks to the block chain.<br /><br />The odds of an attacker succeeding get even smaller as time goes on. For example, if you want to tamper with a transaction in block 51, you'll have to recalculate the proof of work for that block; since the proof of work calculation for block 52 includes the proof of work from block 51, you now also have to recalculate the proof of work for block 52 as well; and then block 53; and in the meantime, you're racing the rest of the network, which has since added blocks 54 and 55, so your chain is not the longest!  <br /><br />The implication here is that older blocks - those further back in the chain - are more "secure" than newer ones.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-6-vnyl60XNc/U1TB98EV5WI/AAAAAAAAQ5Y/DCwVZWg5EiE/s1600/Bitcoin+Block+chain+risk.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-6-vnyl60XNc/U1TB98EV5WI/AAAAAAAAQ5Y/DCwVZWg5EiE/s1600/Bitcoin+Block+chain+risk.png" /></a></div>In fact, if Bob is a merchant, he can tune the level of risk he's willing to tolerate by deciding how many blocks must elapse before he considers a transaction verified. If it's a tiny transaction, a single block (~10 minutes) may be enough; if it's a large transaction, waiting for 6 blocks (~1 hour) may be more advisable. For a merchant, waiting 1 hour to avoid fraud may still be better than the situation today with credit cards, where a chargeback may appear a month after the transaction.</div><br />An important disclaimer: while Bitcoin's design seems sound from a security standpoint, it's still susceptible to fraud as a result of user error, just like any other system. The difference with Bitcoin is that it's a decentralized system: when something goes wrong, there is no one you can call for help.<br /><br />For example, if you accidentally send Bitcoin to the wrong address, there is no way to get that money back. If you fall for a phishing attack, there is no fraud department to report it to. If you lose your private key (e.g. in a hard drive crash), you lose access to any Bitcoins associated with it, and there is <i>nothing</i> anyone can do to help you get them back. In fact, if a private key is lost, those Bitcoins are no longer accessible to <i>anyone</i> on the Bitcoin network; they are gone, effectively out of circulation, forever!<br /><br /><b><span style="font-size: x-large;">Further reading</span></b><br /><br />In the spirit of giving credit where it's due, these are the resources that helped me put this post together, and may help you learn more: <br /><div><ol><li><a href="https://www.youtube.com/watch?v=Lx9zgZCMqXE">How Bitcoin works under the hood</a> (video).</li><li><a href="http://www.michaelnielsen.org/ddi/how-the-bitcoin-protocol-actually-works/">How the Bitcoin protocol actually works</a></li><li><a href="http://dealbook.nytimes.com/2014/01/21/why-bitcoin-matters/?_php=true&amp;_type=blogs&amp;_r=0">Why Bitcoin Matters</a></li><li><a href="https://bitcoin.org/bitcoin.pdf">Bitcoin: a peer-to-peer electronic cash system</a> (PDF)</li><li><a href="http://expectedpayoff.com/blog/2013/03/22/bitcoin-and-the-byzantine-generals-problem/">Bitcoin and the Byzantine Generals Problem</a></li><li><a href="https://bitcoin.org/">Bitcoin homepage</a></li><li><a href="https://bitcoin.org/en/faq">Bitcoin FAQ</a></li><li><a href="https://github.com/bitcoin/bitcoin">Bitcoin source code</a></li><li><a href="http://en.wikipedia.org/wiki/Bitcoin">Bitcoin Wikipedia page</a></li><li><a href="http://tomorrowstransactions.com/2013/04/explaining-bitcoin-to-the-man-in-the-street-sort-of/">Explaining Bitcoin to the man in the street, sort of</a></li></ol></div>